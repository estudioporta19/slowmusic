<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metrónomo Avançado</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Metrónomo Avançado</h1>
        <div class="global-controls">
            <button id="playPauseBtn" class="control-button play-pause-button">▶️ Iniciar</button>
            <button id="stopBtn" class="control-button stop-button">⏹️ Parar</button>
        </div>
        <a href="https://estudioporta19.github.io/slowmusic/" class="back-to-app-button">Voltar à Aplicação</a>
    </header>

    <main>
        <div class="metronome-modes">
            <button id="modeClassicBtn" class="mode-button selected">Clássico</button>
            <button id="modeClaveBtn" class="mode-button">Clave Designer</button>
            <button id="modeListBtn" class="mode-button">Mapa de Tempo</button>
        </div>

        <div id="classicMetronomeModule" class="module-container active-module">
            <h2>Metrónomo Clássico</h2>
            <div class="controls-group">
                <label for="bpmSlider">BPM: <span id="bpmValue">120</span></label>
                <input type="range" id="bpmSlider" min="20" max="300" value="120">
            </div>

            <div class="controls-group">
                <label for="timeNumerator">Compasso: <span id="timeNumeratorValue">4</span> / 4</label>
                <input type="number" id="timeNumerator" min="1" max="16" value="4">
                </div>

            <div class="controls-group">
                <label>Subdivisão:</label>
                <div class="subdivision-buttons">
                    <button id="subdivisionOffBtn" class="subdivision-button selected">Off</button>
                    <button id="subdivision2Btn" class="subdivision-button">2x</button>
                    <button id="subdivision3Btn" class="subdivision-button">3x</button>
                    <button id="subdivision4Btn" class="subdivision-button">4x</button>
                </div>
            </div>

            <div class="controls-group">
                <label for="accentedBeats">Acentuar Batidas (Ex: 2,4):</label>
                <input type="text" id="accentedBeats" placeholder="2,4">
            </div>
        </div>

        <div id="claveDesignerModule" class="module-container hidden">
            <h2>Clave Designer</h2>
            <div class="controls-group">
                <label for="bpmSlider">BPM: <span id="bpmValue">120</span></label>
                <input type="range" id="bpmSlider" min="20" max="300" value="120">
            </div>
            
            <div class="clave-grid-container">
                <div id="claveGrid" class="clave-grid">
                    </div>
            </div>
            <div class="controls-group">
                <label for="claveCycleLength">Ciclo da Clave (Semicolcheias): <span id="claveCycleLengthValue">16</span></label>
                <input type="range" id="claveCycleLength" min="1" max="16" value="16">
            </div>
            <button id="resetClaveBtn" class="control-button">Resetar Clave</button>
        </div>

        <div id="timeMapModule" class="module-container hidden">
            <h2>Mapa de Tempo</h2>
            <div class="time-map-builder">
                <h3>Adicionar Nova Secção</h3>
                <div class="controls-group">
                    <label for="sectionType">Tipo de Secção:</label>
                    <select id="sectionType">
                        <option value="classic">Clássico</option>
                        <option value="clave">Clave</option>
                        <option value="pause">Pausa</option>
                    </select>
                </div>

                <div id="timeMapClassicControls" class="section-config-panel">
                    <div class="controls-group">
                        <label for="sectionBPM">BPM:</label>
                        <input type="number" id="sectionBPM" value="120" min="20" max="300">
                    </div>
                    <div class="controls-group">
                        <label for="sectionNumerator">Compasso:</label>
                        <input type="number" id="sectionNumerator" value="4" min="1" max="16"> / 4
                        </div>
                    <div class="controls-group">
                        <label for="sectionSubdivision">Subdivisão:</label>
                        <select id="sectionSubdivision">
                            <option value="1">Off</option>
                            <option value="2">2x</option>
                            <option value="3">3x</option>
                            <option value="4">4x</option>
                        </select>
                    </div>
                    <div class="controls-group">
                        <label for="sectionAccentedBeats">Acentuar Batidas (Ex: 2,4):</label>
                        <input type="text" id="sectionAccentedBeats" placeholder="2,4">
                    </div>
                </div>

                <div id="timeMapClaveControls" class="section-config-panel hidden">
                    <div class="controls-group">
                        <label for="sectionClaveBPM">BPM:</label>
                        <input type="number" id="sectionClaveBPM" value="120" min="20" max="300">
                    </div>
                    <div class="controls-group">
                        <label for="sectionClavePattern">Padrão da Clave (16 dígitos 0/1/2):</label>
                        <input type="text" id="sectionClavePattern" value="1000100010001000" maxlength="16">
                    </div>
                    <div class="controls-group">
                        <label for="sectionClaveLength">Ciclo (1-16 semicolcheias):</label>
                        <input type="number" id="sectionClaveLength" value="16" min="1" max="16">
                    </div>
                </div>

                <div id="timeMapPauseControls" class="section-config-panel hidden">
                    <div class="controls-group">
                        <label for="sectionPauseDuration">Duração da Pausa (compassos):</label>
                        <input type="number" id="sectionPauseDuration" value="4" min="1">
                    </div>
                </div>
                
                <div class="controls-group">
                    <label for="sectionMeasures">Duração da Secção (compassos):</label>
                    <input type="number" id="sectionMeasures" value="4" min="1">
                </div>
                <button id="addSectionBtn" class="control-button">Adicionar Secção</button>
            </div>

            <h3>Secções do Mapa</h3>
            <ul id="timeMapSectionsList" class="time-map-sections-list">
                </ul>
        </div>
    </main>

    <footer>
        <p>Status: <span id="metronomeStatus"></span></p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
